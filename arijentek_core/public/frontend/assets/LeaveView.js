var A=(U,k,v)=>new Promise((b,_)=>{var u=i=>{try{f(v.next(i))}catch(p){_(p)}},y=i=>{try{f(v.throw(i))}catch(p){_(p)}},f=i=>i.done?b(i.value):Promise.resolve(i.value).then(u,y);f((v=v.apply(U,k)).next())});import{c as B,d as X,m as G,a as l,b as e,g as d,h as c,k as g,t as o,i as m,F as h,y as D,T as J,A as R,B as P,r as x,x as K,o as a,s as T,w as q,X as O,f as L,C as Q,v as j,D as W,j as Y}from"./main.js";import{l as S,d as Z}from"./api.js";import{B as ee}from"./briefcase.js";import{C as te}from"./calendar.js";import{C as se,L as ae}from"./loader-circle.js";/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=B("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=B("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=B("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=B("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),ie={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-8 animate-fade-in"},de={key:0,class:"flex items-center justify-center py-20"},ue={key:1,class:"space-y-6 animate-slide-up"},ce={key:0,class:"glass-card p-5"},me={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},pe={key:0,class:"flex items-center gap-3"},xe={class:"w-10 h-10 rounded-xl bg-blue-500/10 text-blue-400 flex items-center justify-center"},ve={class:"text-sm font-medium text-white"},fe={class:"text-xs text-slate-500"},ge={key:1,class:"flex items-center gap-3"},ye={class:"w-10 h-10 rounded-xl bg-purple-500/10 text-purple-400 flex items-center justify-center"},be={class:"text-sm font-medium text-white"},_e={class:"text-xs text-slate-500"},he={key:0,class:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4"},ke=["title"],we={class:"glass-card p-5 border-accent/20"},Ce={class:"text-3xl font-bold text-accent"},Le={key:1,class:"glass-card p-8 text-center"},Se={key:0,class:"glass-card overflow-hidden"},ze={class:"hidden sm:block overflow-x-auto"},Ae={class:"w-full"},De={class:"px-5 py-4"},Te={class:"text-sm font-medium text-white"},Be={class:"px-5 py-4"},Me={class:"text-sm text-slate-300"},je={class:"px-5 py-4 text-center"},Ue={class:"text-sm font-semibold text-white"},Ve={class:"px-5 py-4 text-center"},Fe={class:"px-5 py-4 text-right"},Ne=["onClick"],$e={class:"sm:hidden divide-y divide-white/[0.04]"},Re={class:"flex items-center justify-between"},Pe={class:"text-sm font-medium text-white"},qe={class:"text-xs text-slate-500"},Oe=["onClick"],Ee={key:1,class:"glass-card p-8 text-center"},He={class:"modal-content glass-card w-full max-w-md p-6 space-y-5"},Ie={class:"flex items-center justify-between"},Xe={class:"relative"},Ge=["value"],Je={class:"grid grid-cols-2 gap-3"},Ke={class:"flex items-center gap-3 cursor-pointer"},Qe={key:0,class:"flex items-start gap-2 text-sm text-red-400 bg-red-500/10 p-3 rounded-xl"},We=["disabled"],Ye={key:0,class:"fixed bottom-24 lg:bottom-8 left-1/2 -translate-x-1/2 z-50 flex items-center gap-2 bg-emerald-500/15 border border-emerald-500/20 text-emerald-400 px-5 py-3 rounded-xl shadow-lg"},Ze={class:"text-sm font-medium"},nt=X({__name:"LeaveView",setup(U){const k=x(!0),v=x([]),b=x([]),_=x([]),u=x(null),y=x(!1),f=x(!1),i=x(""),p=x(""),r=x({leave_type:"",from_date:"",to_date:"",half_day:0,reason:""}),E=K(()=>v.value.reduce((n,t)=>n+t.balance,0)),V=[{bg:"bg-teal-500/10",text:"text-teal-400",ring:"ring-teal-500/20"},{bg:"bg-blue-500/10",text:"text-blue-400",ring:"ring-blue-500/20"},{bg:"bg-purple-500/10",text:"text-purple-400",ring:"ring-purple-500/20"},{bg:"bg-amber-500/10",text:"text-amber-400",ring:"ring-amber-500/20"},{bg:"bg-rose-500/10",text:"text-rose-400",ring:"ring-rose-500/20"},{bg:"bg-emerald-500/10",text:"text-emerald-400",ring:"ring-emerald-500/20"}];function F(n){return V[n%V.length]}function N(n){return{Open:"badge-warning",Approved:"badge-success",Rejected:"badge-danger",Cancelled:"badge-neutral"}[n]||"badge-neutral"}function M(){return A(this,null,function*(){k.value=!0;try{const[n,t,w,C]=yield Promise.allSettled([S.getBalance(),S.getApplications(),S.getTypes(),Z.getReportingInfo()]);n.status==="fulfilled"&&(v.value=n.value||[]),t.status==="fulfilled"&&(b.value=t.value||[]),w.status==="fulfilled"&&(_.value=w.value||[]),C.status==="fulfilled"&&(u.value=C.value)}finally{k.value=!1}})}function H(){r.value={leave_type:_.value[0]||"",from_date:"",to_date:"",half_day:0,reason:""},i.value="",p.value="",y.value=!0}function I(){return A(this,null,function*(){f.value=!0,i.value="",p.value="";try{const n=yield S.apply(r.value);n.success?(p.value=`Leave application ${n.name} submitted successfully!`,y.value=!1,yield M()):i.value=n.error||"Failed to submit"}catch(n){i.value=n.message||"Something went wrong"}finally{f.value=!1}})}function $(n){return A(this,null,function*(){if(confirm("Cancel this leave application?"))try{(yield S.cancel(n)).success&&(yield M())}catch(t){alert(t.message||"Failed to cancel")}})}return G(M),(n,t)=>{var w,C;return a(),l("div",null,[e("div",ie,[t[9]||(t[9]=e("div",null,[e("h1",{class:"text-2xl sm:text-3xl font-bold text-white"},"Leave Management"),e("p",{class:"text-sm text-slate-500 mt-1"},"Track, apply and manage your leaves")],-1)),e("button",{onClick:H,class:"btn-accent flex items-center gap-2 self-start"},[d(c(ne),{size:18}),t[8]||(t[8]=g(" Apply Leave ",-1))])]),k.value?(a(),l("div",de,[...t[10]||(t[10]=[e("div",{class:"w-10 h-10 border-2 border-accent/30 border-t-accent rounded-full animate-spin"},null,-1)])])):(a(),l("div",ue,[(w=u.value)!=null&&w.reporting_manager||(C=u.value)!=null&&C.leave_approver?(a(),l("div",ce,[t[13]||(t[13]=e("h3",{class:"text-sm font-semibold text-slate-400 uppercase tracking-wider mb-4"},"Reporting & Approval",-1)),e("div",me,[u.value.reporting_manager?(a(),l("div",pe,[e("div",xe,[d(c(re),{size:18,"stroke-width":1.8})]),e("div",null,[t[11]||(t[11]=e("p",{class:"text-xs text-slate-500"},"Reporting Manager",-1)),e("p",ve,o(u.value.reporting_manager.employee_name),1),e("p",fe,o(u.value.reporting_manager.designation),1)])])):m("",!0),u.value.leave_approver?(a(),l("div",ge,[e("div",ye,[d(c(ee),{size:18,"stroke-width":1.8})]),e("div",null,[t[12]||(t[12]=e("p",{class:"text-xs text-slate-500"},"Leave Approver",-1)),e("p",be,o(u.value.leave_approver.employee_name),1),e("p",_e,o(u.value.leave_approver.designation),1)])])):m("",!0)])])):m("",!0),e("div",null,[t[18]||(t[18]=e("h3",{class:"text-sm font-semibold text-slate-400 uppercase tracking-wider mb-4"},"Leave Balance",-1)),v.value.length?(a(),l("div",he,[(a(!0),l(h,null,D(v.value,(s,z)=>(a(),l("div",{key:s.leave_type,class:T(["glass-card-hover p-5 ring-1",F(z).ring])},[e("p",{class:"text-sm font-medium text-slate-400 mb-2 truncate",title:s.leave_type},o(s.leave_type),9,ke),e("p",{class:T(["text-3xl font-bold",F(z).text])},o(s.balance),3),t[14]||(t[14]=e("p",{class:"text-xs text-slate-500 mt-1"},"days",-1))],2))),128)),e("div",we,[t[15]||(t[15]=e("p",{class:"text-sm font-medium text-slate-400 mb-2"},"Total",-1)),e("p",Ce,o(E.value),1),t[16]||(t[16]=e("p",{class:"text-xs text-slate-500 mt-1"},"days remaining",-1))])])):(a(),l("div",Le,[d(c(J),{size:32,class:"mx-auto text-slate-600 mb-2"}),t[17]||(t[17]=e("p",{class:"text-slate-500 text-sm"},"No leave balance data available",-1))]))]),e("div",null,[t[21]||(t[21]=e("h3",{class:"text-sm font-semibold text-slate-400 uppercase tracking-wider mb-4"}," My Applications ",-1)),b.value.length?(a(),l("div",Se,[e("div",ze,[e("table",Ae,[t[19]||(t[19]=e("thead",null,[e("tr",{class:"border-b border-white/[0.06]"},[e("th",{class:"text-left text-xs font-semibold text-slate-500 uppercase tracking-wider px-5 py-3"},"Type"),e("th",{class:"text-left text-xs font-semibold text-slate-500 uppercase tracking-wider px-5 py-3"},"Period"),e("th",{class:"text-center text-xs font-semibold text-slate-500 uppercase tracking-wider px-5 py-3"},"Days"),e("th",{class:"text-center text-xs font-semibold text-slate-500 uppercase tracking-wider px-5 py-3"},"Status"),e("th",{class:"text-right text-xs font-semibold text-slate-500 uppercase tracking-wider px-5 py-3"},"Action")])],-1)),e("tbody",null,[(a(!0),l(h,null,D(b.value,s=>(a(),l("tr",{key:s.name,class:"border-b border-white/[0.03] hover:bg-white/[0.02] transition-colors"},[e("td",De,[e("p",Te,o(s.leave_type),1)]),e("td",Be,[e("p",Me,[g(o(new Date(s.from_date).toLocaleDateString("en-US",{month:"short",day:"numeric"}))+" ",1),s.from_date!==s.to_date?(a(),l(h,{key:0},[g(" — "+o(new Date(s.to_date).toLocaleDateString("en-US",{month:"short",day:"numeric"})),1)],64)):m("",!0)])]),e("td",je,[e("span",Ue,o(s.total_leave_days),1)]),e("td",Ve,[e("span",{class:T(N(s.status))},o(s.status),3)]),e("td",Fe,[s.status==="Open"?(a(),l("button",{key:0,onClick:z=>$(s.name),class:"text-xs text-red-400 hover:text-red-300 transition-colors"}," Cancel ",8,Ne)):m("",!0)])]))),128))])])]),e("div",$e,[(a(!0),l(h,null,D(b.value,s=>(a(),l("div",{key:s.name,class:"p-4 space-y-2"},[e("div",Re,[e("p",Pe,o(s.leave_type),1),e("span",{class:T(N(s.status))},o(s.status),3)]),e("p",qe,[g(o(new Date(s.from_date).toLocaleDateString("en-US",{month:"short",day:"numeric"}))+" ",1),s.from_date!==s.to_date?(a(),l(h,{key:0},[g(" — "+o(new Date(s.to_date).toLocaleDateString("en-US",{month:"short",day:"numeric"})),1)],64)):m("",!0),g(" · "+o(s.total_leave_days)+" day"+o(s.total_leave_days!==1?"s":""),1)]),s.status==="Open"?(a(),l("button",{key:0,onClick:z=>$(s.name),class:"text-xs text-red-400 hover:text-red-300"},"Cancel",8,Oe)):m("",!0)]))),128))])])):(a(),l("div",Ee,[d(c(te),{size:32,class:"mx-auto text-slate-600 mb-2"}),t[20]||(t[20]=e("p",{class:"text-slate-500 text-sm"},"No leave applications yet",-1))]))])])),d(P,{name:"modal"},{default:R(()=>[y.value?(a(),l("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",onClick:t[6]||(t[6]=q(s=>y.value=!1,["self"]))},[e("div",He,[e("div",Ie,[t[22]||(t[22]=e("h2",{class:"text-lg font-semibold text-white"},"Apply for Leave",-1)),e("button",{onClick:t[0]||(t[0]=s=>y.value=!1),class:"text-slate-500 hover:text-white transition-colors p-1"},[d(c(O),{size:20})])]),e("form",{onSubmit:q(I,["prevent"]),class:"space-y-4"},[e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-slate-400 mb-1.5"},"Leave Type",-1)),e("div",Xe,[L(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>r.value.leave_type=s),class:"input-dark appearance-none pr-10 cursor-pointer"},[(a(!0),l(h,null,D(_.value,s=>(a(),l("option",{key:s,value:s},o(s),9,Ge))),128))],512),[[Q,r.value.leave_type]]),d(c(le),{size:16,class:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 pointer-events-none"})])]),e("div",Je,[e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-slate-400 mb-1.5"},"From",-1)),L(e("input",{type:"date","onUpdate:modelValue":t[2]||(t[2]=s=>r.value.from_date=s),required:"",class:"input-dark"},null,512),[[j,r.value.from_date]])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-slate-400 mb-1.5"},"To",-1)),L(e("input",{type:"date","onUpdate:modelValue":t[3]||(t[3]=s=>r.value.to_date=s),required:"",class:"input-dark"},null,512),[[j,r.value.to_date]])])]),e("label",Ke,[L(e("input",{type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":t[4]||(t[4]=s=>r.value.half_day=s),class:"w-4 h-4 rounded border-white/10 bg-white/5 text-accent focus:ring-accent/30"},null,512),[[W,r.value.half_day]]),t[26]||(t[26]=e("span",{class:"text-sm text-slate-400"},"Half day",-1))]),e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-slate-400 mb-1.5"},[g("Reason "),e("span",{class:"text-slate-600"},"(optional)")],-1)),L(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=s=>r.value.reason=s),rows:"3",class:"input-dark resize-none",placeholder:"Briefly describe the reason..."},null,512),[[j,r.value.reason]])]),i.value?(a(),l("div",Qe,[d(c(se),{size:16,class:"mt-0.5 shrink-0"}),g(" "+o(i.value),1)])):m("",!0),e("button",{type:"submit",disabled:f.value||!r.value.leave_type||!r.value.from_date||!r.value.to_date,class:"btn-accent w-full flex items-center justify-center gap-2"},[f.value?(a(),Y(c(ae),{key:0,size:18,class:"animate-spin"})):m("",!0),e("span",null,o(f.value?"Submitting...":"Submit Application"),1)],8,We)],32)])])):m("",!0)]),_:1}),d(P,{name:"modal"},{default:R(()=>[p.value?(a(),l("div",Ye,[d(c(oe),{size:18}),e("span",Ze,o(p.value),1),e("button",{onClick:t[7]||(t[7]=s=>p.value=""),class:"ml-2 text-emerald-400/60 hover:text-emerald-400"},[d(c(O),{size:16})])])):m("",!0)]),_:1})])}}});export{nt as default};
