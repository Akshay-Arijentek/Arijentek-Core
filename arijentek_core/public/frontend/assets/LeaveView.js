var $=(R,T,g)=>new Promise((k,f)=>{var z=x=>{try{u(g.next(x))}catch(b){f(b)}},p=x=>{try{u(g.throw(x))}catch(b){f(b)}},u=x=>x.done?k(x.value):Promise.resolve(x.value).then(z,p);u((g=g.apply(R,T)).next())});import{c as oe,d as re,D as ne,r as m,m as ie,a as l,b as e,g as d,h as y,k as _,t as o,i as c,f as A,y as I,F as h,n as L,T as de,E as G,G as W,p as H,o as a,B as j,w as X,X as J,v as N,H as ce,j as ue}from"./main.js";import{u as M,l as D,d as ve}from"./api.js";import{P as ye}from"./plus.js";import{B as me}from"./briefcase.js";import{C as K,a as Q}from"./chevron-down.js";import{C as pe}from"./circle-alert.js";import{L as xe}from"./loader-circle.js";import{C as ge}from"./circle-check.js";/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=oe("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),be={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-8 animate-fade-in"},_e={key:0,class:"flex items-center justify-center py-20"},he={key:1,class:"space-y-6 animate-slide-up"},ke={key:0,class:"glass-card p-5"},we={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Ce={key:0,class:"flex items-center gap-3"},Se={class:"w-10 h-10 rounded-xl flex items-center justify-center",style:{backgroundColor:"var(--info-bg)",color:"var(--info-text)"}},Ae={class:"text-sm font-medium",style:{color:"var(--heading-color)"}},Le={class:"text-xs",style:{color:"var(--text-tertiary)"}},De={key:1,class:"flex items-center gap-3"},ze={class:"w-10 h-10 rounded-xl flex items-center justify-center",style:{backgroundColor:"rgba(168,85,247,0.1)",color:"#a855f7"}},Be={class:"text-sm font-medium",style:{color:"var(--heading-color)"}},Fe={class:"text-xs",style:{color:"var(--text-tertiary)"}},Me={key:1,class:"glass-card p-5"},Te={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-4"},Ue={class:"flex items-center gap-2 shrink-0"},$e={class:"relative"},je=["value"],Ve={class:"relative"},He={class:"holidays-scroll grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 max-h-64 overflow-y-auto overflow-x-hidden"},Ne={class:"w-10 h-10 rounded-lg flex items-center justify-center shrink-0",style:{backgroundColor:"var(--warning-bg)",color:"var(--warning-text)"}},Re={class:"min-w-0"},Ee={class:"text-sm font-medium",style:{color:"var(--heading-color)"}},Oe={class:"text-xs truncate",style:{color:"var(--text-tertiary)"}},Pe={key:0,class:"text-sm py-6 text-center",style:{color:"var(--text-tertiary)"}},Ye={key:0,class:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-4"},qe=["title"],Ie={class:"glass-card p-5",style:{boxShadow:"inset 0 0 0 1px rgba(20,184,166,0.2)"}},Ge={class:"text-3xl font-bold",style:{color:"var(--accent)"}},We={key:1,class:"glass-card p-8 text-center"},Xe={key:0,class:"glass-card overflow-hidden"},Je={class:"hidden sm:block overflow-x-auto"},Ke={class:"w-full"},Qe={class:"px-5 py-4"},Ze={class:"text-sm font-medium",style:{color:"var(--heading-color)"}},et={class:"px-5 py-4"},tt={class:"text-sm",style:{color:"var(--text-secondary)"}},st={class:"px-5 py-4 text-center"},at={class:"text-sm font-semibold",style:{color:"var(--heading-color)"}},lt={class:"px-5 py-4 text-center"},ot={class:"px-5 py-4 text-right"},rt=["onClick"],nt={class:"sm:hidden divide-y",style:{borderColor:"var(--border-color)"}},it={class:"flex items-center justify-between"},dt={class:"text-sm font-medium",style:{color:"var(--heading-color)"}},ct={class:"text-xs",style:{color:"var(--text-tertiary)"}},ut=["onClick"],vt={key:1,class:"glass-card p-8 text-center"},yt={class:"modal-content glass-card w-full max-w-md p-6 space-y-5"},mt={class:"flex items-center justify-between"},pt={class:"relative"},xt=["disabled"],gt=["value"],ft={key:0,value:"",disabled:""},bt={class:"grid grid-cols-2 gap-3"},_t={class:"flex items-center gap-3 cursor-pointer"},ht={key:0,class:"flex items-start gap-2 text-sm p-3 rounded-xl",style:{backgroundColor:"var(--danger-bg)",color:"var(--danger-text)"}},kt=["disabled"],wt={key:0,class:"fixed bottom-24 lg:bottom-8 left-1/2 -translate-x-1/2 z-50 flex items-center gap-2 px-5 py-3 rounded-xl shadow-lg",style:{backgroundColor:"var(--success-bg)",border:"1px solid var(--success-text)",color:"var(--success-text)"}},Ct={class:"text-sm font-medium"},Ut=re({__name:"LeaveView",setup(R){const T=m(!0),g=m([]),k=m([]),f=m([]),z=m([]),p=m(null);let u=!0;ne(()=>{u=!1});const x=new Date,b=m(`${x.getFullYear()}-${String(x.getMonth()+1).padStart(2,"0")}`),B=m(!1),F=m(!1),w=m(""),C=m(""),i=m({leave_type:"",from_date:"",to_date:"",half_day:0,reason:""}),Z=H(()=>g.value.reduce((n,t)=>n+t.balance,0)),ee=H(()=>{const t=new Date().getFullYear(),r=[{value:"",label:"All months"}];for(let v=t;v<=t+1;v++)for(let s=1;s<=12;s++){const S=`${v}-${String(s).padStart(2,"0")}`,le=new Date(v,s-1,1);r.push({value:S,label:le.toLocaleDateString("en-US",{month:"long",year:"numeric"})})}return r}),E=H(()=>{const n=z.value;return b.value?n.filter(t=>t.holiday_date.startsWith(b.value)):n}),O=[{bg:"rgba(20,184,166,0.1)",text:"var(--accent)",ring:"rgba(20,184,166,0.2)"},{bg:"var(--info-bg)",text:"var(--info-text)",ring:"rgba(59,130,246,0.2)"},{bg:"rgba(168,85,247,0.1)",text:"#a855f7",ring:"rgba(168,85,247,0.2)"},{bg:"var(--warning-bg)",text:"var(--warning-text)",ring:"rgba(245,158,11,0.2)"},{bg:"var(--danger-bg)",text:"var(--danger-text)",ring:"rgba(239,68,68,0.2)"},{bg:"var(--success-bg)",text:"var(--success-text)",ring:"rgba(34,197,94,0.2)"}];function P(n){return O[n%O.length]}const Y={Open:{bg:"var(--warning-bg)",text:"var(--warning-text)"},Approved:{bg:"var(--success-bg)",text:"var(--success-text)"},Rejected:{bg:"var(--danger-bg)",text:"var(--danger-text)"},Cancelled:{bg:"var(--neutral-bg)",text:"var(--neutral-text)"}};function U(n){return Y[n]||Y.Cancelled}function te(){const t=new Date().getFullYear();return{from:`${t}-01-01`,to:`${t}-12-31`}}function V(){return $(this,null,function*(){const{from:n,to:t}=te();M("leave_balance",D.getBalance,r=>{if(!u)return;const v=Array.isArray(r)?r:r||[];Array.isArray(v)&&(g.value=v,T.value=!1)}),M("leave_applications",D.getApplications,r=>{if(!u)return;const v=Array.isArray(r)?r:r||[];Array.isArray(v)&&(k.value=v)}),M("leave_types",D.getTypes,r=>{u&&Array.isArray(r)&&(f.value=r)}),M("reporting_info",ve.getReportingInfo,r=>{u&&r&&(p.value=r)}),M("holidays",()=>D.getHolidays(n,t,!0),r=>{u&&Array.isArray(r)&&(z.value=r)})})}function se(){i.value={leave_type:f.value[0]||"",from_date:"",to_date:"",half_day:0,reason:""},w.value="",C.value="",B.value=!0}function ae(){return $(this,null,function*(){F.value=!0,w.value="",C.value="";try{const n=yield D.apply(i.value);if(!u)return;n.success?(C.value=`Leave application ${n.name} submitted successfully!`,B.value=!1,yield V()):w.value=n.error||"Failed to submit"}catch(n){u&&(w.value=n.message||"Something went wrong")}finally{u&&(F.value=!1)}})}function q(n){return $(this,null,function*(){if(confirm("Cancel this leave application?"))try{(yield D.cancel(n)).success&&(yield V())}catch(t){alert(t.message||"Failed to cancel")}})}return ie(V),(n,t)=>{var r,v;return a(),l("div",null,[e("div",be,[t[10]||(t[10]=e("div",null,[e("h1",{class:"text-2xl sm:text-3xl font-bold",style:{color:"var(--heading-color)"}},"Leave Management"),e("p",{class:"text-sm mt-1",style:{color:"var(--text-tertiary)"}},"Track, apply and manage your leaves")],-1)),e("button",{onClick:se,class:"btn-accent flex items-center gap-2 self-start"},[d(y(ye),{size:18}),t[9]||(t[9]=_(" Apply Leave ",-1))])]),T.value?(a(),l("div",_e,[...t[11]||(t[11]=[e("div",{class:"w-10 h-10 border-2 rounded-full animate-spin",style:{borderColor:"var(--border-color)",borderTopColor:"var(--accent)"}},null,-1)])])):(a(),l("div",he,[(r=p.value)!=null&&r.reporting_manager||(v=p.value)!=null&&v.leave_approver?(a(),l("div",ke,[t[14]||(t[14]=e("h3",{class:"text-sm font-semibold uppercase tracking-wider mb-4",style:{color:"var(--text-secondary)"}},"Reporting & Approval",-1)),e("div",we,[p.value.reporting_manager?(a(),l("div",Ce,[e("div",Se,[d(y(fe),{size:18,"stroke-width":1.8})]),e("div",null,[t[12]||(t[12]=e("p",{class:"text-xs",style:{color:"var(--text-tertiary)"}},"Reporting Manager",-1)),e("p",Ae,o(p.value.reporting_manager.employee_name),1),e("p",Le,o(p.value.reporting_manager.designation),1)])])):c("",!0),p.value.leave_approver?(a(),l("div",De,[e("div",ze,[d(y(me),{size:18,"stroke-width":1.8})]),e("div",null,[t[13]||(t[13]=e("p",{class:"text-xs",style:{color:"var(--text-tertiary)"}},"Leave Approver",-1)),e("p",Be,o(p.value.leave_approver.employee_name),1),e("p",Fe,o(p.value.leave_approver.designation),1)])])):c("",!0)])])):c("",!0),z.value.length?(a(),l("div",Me,[e("div",Te,[t[16]||(t[16]=e("div",null,[e("h3",{class:"text-sm font-semibold uppercase tracking-wider",style:{color:"var(--text-secondary)"}},"Company Holidays"),e("p",{class:"text-xs mt-1",style:{color:"var(--text-tertiary)"}},"From your assigned Holiday List")],-1)),e("div",Ue,[t[15]||(t[15]=e("label",{class:"text-xs whitespace-nowrap",style:{color:"var(--text-tertiary)"}},"Filter:",-1)),e("div",$e,[A(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>b.value=s),class:"input-dark appearance-none pr-8 pl-3 py-2 text-sm cursor-pointer min-w-[160px]"},[(a(!0),l(h,null,L(ee.value,s=>(a(),l("option",{key:s.value,value:s.value},o(s.label),9,je))),128))],512),[[I,b.value]]),d(y(K),{size:14,class:"absolute right-2.5 top-1/2 -translate-y-1/2 pointer-events-none",style:{color:"var(--text-tertiary)"}})])])]),e("div",Ve,[e("div",He,[(a(!0),l(h,null,L(E.value,s=>(a(),l("div",{key:s.holiday_date,class:"flex items-center gap-3 py-2 px-3 rounded-lg",style:{backgroundColor:"var(--glass-bg)",border:"1px solid var(--border-color)"}},[e("div",Ne,[d(y(Q),{size:18,"stroke-width":1.8})]),e("div",Re,[e("p",Ee,o(new Date(s.holiday_date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})),1),e("p",Oe,o(s.description||"Holiday"),1)])]))),128))]),E.value.length===0?(a(),l("p",Pe," No holidays in selected month ")):c("",!0)])])):c("",!0),e("div",null,[t[21]||(t[21]=e("h3",{class:"text-sm font-semibold uppercase tracking-wider mb-4",style:{color:"var(--text-secondary)"}},"Leave Balance",-1)),t[22]||(t[22]=e("p",{class:"text-xs mb-4",style:{color:"var(--text-tertiary)"}},"Casual Leave, Sick Leave, Earned Leave, Regional Holidays",-1)),g.value.length?(a(),l("div",Ye,[(a(!0),l(h,null,L(g.value,(s,S)=>(a(),l("div",{key:s.leave_type,class:"glass-card-hover p-5",style:j({boxShadow:`inset 0 0 0 1px ${P(S).ring}`})},[e("p",{class:"text-sm font-medium mb-2 truncate",title:s.leave_type,style:{color:"var(--text-secondary)"}},o(s.leave_type),9,qe),e("p",{class:"text-3xl font-bold",style:j({color:P(S).text})},o(s.balance),5),t[17]||(t[17]=e("p",{class:"text-xs mt-1",style:{color:"var(--text-tertiary)"}},"days",-1))],4))),128)),e("div",Ie,[t[18]||(t[18]=e("p",{class:"text-sm font-medium mb-2",style:{color:"var(--text-secondary)"}},"Total",-1)),e("p",Ge,o(Z.value),1),t[19]||(t[19]=e("p",{class:"text-xs mt-1",style:{color:"var(--text-tertiary)"}},"days remaining",-1))])])):(a(),l("div",We,[d(y(de),{size:32,class:"mx-auto mb-2",style:{color:"var(--text-tertiary)"}}),t[20]||(t[20]=e("p",{class:"text-sm",style:{color:"var(--text-tertiary)"}},"No leave balance data available",-1))]))]),e("div",null,[t[25]||(t[25]=e("h3",{class:"text-sm font-semibold uppercase tracking-wider mb-4",style:{color:"var(--text-secondary)"}}," My Applications ",-1)),k.value.length?(a(),l("div",Xe,[e("div",Je,[e("table",Ke,[t[23]||(t[23]=e("thead",null,[e("tr",{style:{borderBottom:"1px solid var(--border-color)"}},[e("th",{class:"text-left text-xs font-semibold uppercase tracking-wider px-5 py-3",style:{color:"var(--text-tertiary)"}},"Type"),e("th",{class:"text-left text-xs font-semibold uppercase tracking-wider px-5 py-3",style:{color:"var(--text-tertiary)"}},"Period"),e("th",{class:"text-center text-xs font-semibold uppercase tracking-wider px-5 py-3",style:{color:"var(--text-tertiary)"}},"Days"),e("th",{class:"text-center text-xs font-semibold uppercase tracking-wider px-5 py-3",style:{color:"var(--text-tertiary)"}},"Status"),e("th",{class:"text-right text-xs font-semibold uppercase tracking-wider px-5 py-3",style:{color:"var(--text-tertiary)"}},"Action")])],-1)),e("tbody",null,[(a(!0),l(h,null,L(k.value,s=>(a(),l("tr",{key:s.name,class:"transition-colors",style:{borderBottom:"1px solid var(--border-color)"}},[e("td",Qe,[e("p",Ze,o(s.leave_type),1)]),e("td",et,[e("p",tt,[_(o(new Date(s.from_date).toLocaleDateString("en-US",{month:"short",day:"numeric"}))+" ",1),s.from_date!==s.to_date?(a(),l(h,{key:0},[_(" — "+o(new Date(s.to_date).toLocaleDateString("en-US",{month:"short",day:"numeric"})),1)],64)):c("",!0)])]),e("td",st,[e("span",at,o(s.total_leave_days),1)]),e("td",lt,[e("span",{class:"inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold",style:j({backgroundColor:U(s.status).bg,color:U(s.status).text})},o(s.status),5)]),e("td",ot,[s.status==="Open"?(a(),l("button",{key:0,onClick:S=>q(s.name),class:"text-xs transition-colors",style:{color:"var(--danger-text)"}}," Cancel ",8,rt)):c("",!0)])]))),128))])])]),e("div",nt,[(a(!0),l(h,null,L(k.value,s=>(a(),l("div",{key:s.name,class:"p-4 space-y-2"},[e("div",it,[e("p",dt,o(s.leave_type),1),e("span",{class:"inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold",style:j({backgroundColor:U(s.status).bg,color:U(s.status).text})},o(s.status),5)]),e("p",ct,[_(o(new Date(s.from_date).toLocaleDateString("en-US",{month:"short",day:"numeric"}))+" ",1),s.from_date!==s.to_date?(a(),l(h,{key:0},[_(" — "+o(new Date(s.to_date).toLocaleDateString("en-US",{month:"short",day:"numeric"})),1)],64)):c("",!0),_(" · "+o(s.total_leave_days)+" day"+o(s.total_leave_days!==1?"s":""),1)]),s.status==="Open"?(a(),l("button",{key:0,onClick:S=>q(s.name),class:"text-xs",style:{color:"var(--danger-text)"}},"Cancel",8,ut)):c("",!0)]))),128))])])):(a(),l("div",vt,[d(y(Q),{size:32,class:"mx-auto mb-2",style:{color:"var(--text-tertiary)"}}),t[24]||(t[24]=e("p",{class:"text-sm",style:{color:"var(--text-tertiary)"}},"No leave applications yet",-1))]))])])),d(W,{name:"modal"},{default:G(()=>[B.value?(a(),l("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 backdrop-blur-sm",style:{backgroundColor:"var(--overlay-bg)"},onClick:t[7]||(t[7]=X(s=>B.value=!1,["self"]))},[e("div",yt,[e("div",mt,[t[26]||(t[26]=e("h2",{class:"text-lg font-semibold",style:{color:"var(--heading-color)"}},"Apply for Leave",-1)),e("button",{onClick:t[1]||(t[1]=s=>B.value=!1),class:"p-1 transition-colors",style:{color:"var(--text-tertiary)"}},[d(y(J),{size:20})])]),e("form",{onSubmit:X(ae,["prevent"]),class:"space-y-4"},[e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-medium mb-1.5",style:{color:"var(--text-secondary)"}},"Leave Type",-1)),e("div",pt,[A(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>i.value.leave_type=s),class:"input-dark appearance-none pr-10 cursor-pointer",disabled:!f.value.length},[t[27]||(t[27]=e("option",{value:"",disabled:""},"Select leave type",-1)),(a(!0),l(h,null,L(f.value,s=>(a(),l("option",{key:s,value:s},o(s),9,gt))),128)),f.value.length?c("",!0):(a(),l("option",ft,"No leave types"))],8,xt),[[I,i.value.leave_type]]),d(y(K),{size:16,class:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none",style:{color:"var(--text-tertiary)"}})])]),e("div",bt,[e("div",null,[t[29]||(t[29]=e("label",{class:"block text-sm font-medium mb-1.5",style:{color:"var(--text-secondary)"}},"From",-1)),A(e("input",{type:"date","onUpdate:modelValue":t[3]||(t[3]=s=>i.value.from_date=s),required:"",class:"input-dark"},null,512),[[N,i.value.from_date]])]),e("div",null,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium mb-1.5",style:{color:"var(--text-secondary)"}},"To",-1)),A(e("input",{type:"date","onUpdate:modelValue":t[4]||(t[4]=s=>i.value.to_date=s),required:"",class:"input-dark"},null,512),[[N,i.value.to_date]])])]),e("label",_t,[A(e("input",{type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":t[5]||(t[5]=s=>i.value.half_day=s),class:"w-4 h-4 rounded",style:{accentColor:"var(--accent)"}},null,512),[[ce,i.value.half_day]]),t[31]||(t[31]=e("span",{class:"text-sm",style:{color:"var(--text-secondary)"}},"Half day",-1))]),e("div",null,[t[32]||(t[32]=e("label",{class:"block text-sm font-medium mb-1.5",style:{color:"var(--text-secondary)"}},[_(" Reason "),e("span",{style:{color:"var(--text-tertiary)"}},"(optional)")],-1)),A(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=s=>i.value.reason=s),rows:"3",class:"input-dark resize-none",placeholder:"Briefly describe the reason..."},null,512),[[N,i.value.reason]])]),w.value?(a(),l("div",ht,[d(y(pe),{size:16,class:"mt-0.5 shrink-0"}),_(" "+o(w.value),1)])):c("",!0),e("button",{type:"submit",disabled:F.value||!i.value.leave_type||!i.value.from_date||!i.value.to_date,class:"btn-accent w-full flex items-center justify-center gap-2"},[F.value?(a(),ue(y(xe),{key:0,size:18,class:"animate-spin"})):c("",!0),e("span",null,o(F.value?"Submitting...":"Submit Application"),1)],8,kt)],32)])])):c("",!0)]),_:1}),d(W,{name:"modal"},{default:G(()=>[C.value?(a(),l("div",wt,[d(y(ge),{size:18}),e("span",Ct,o(C.value),1),e("button",{onClick:t[8]||(t[8]=s=>C.value=""),class:"ml-2 opacity-60 hover:opacity-100"},[d(y(J),{size:16})])])):c("",!0)]),_:1})])}}});export{Ut as default};
