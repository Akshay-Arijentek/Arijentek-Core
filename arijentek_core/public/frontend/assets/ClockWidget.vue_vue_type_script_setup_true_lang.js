var x=(C,y,i)=>new Promise((v,a)=>{var t=s=>{try{l(i.next(s))}catch(h){a(h)}},r=s=>{try{l(i.throw(s))}catch(h){a(h)}},l=s=>s.done?v(s.value):Promise.resolve(s.value).then(t,r);l((i=i.apply(C,y)).next())});import{c as b,d as L,u as O,m as P,z as R,o,a as n,b as u,A as U,q as j,F as W,t as p,i as T,k as _,r as m,p as d}from"./main.js";import{a as N}from"./api.js";/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=b("calendar-clock",[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=b("calendar-heart",[["path",{d:"M12.127 22H5a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v5.125",key:"vxdnp4"}],["path",{d:"M14.62 18.8A2.25 2.25 0 1 1 18 15.836a2.25 2.25 0 1 1 3.38 2.966l-2.626 2.856a.998.998 0 0 1-1.507 0z",key:"15cy7q"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=b("calendar-x",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m14 14-4 4",key:"rymu2i"}],["path",{d:"m10 14 4 4",key:"3sz06r"}]]),X={class:"flex flex-col items-center"},G={class:"relative mb-6"},J={width:"200",height:"200",class:"transform -rotate-90"},K=["stroke","stroke-dashoffset"],Q=["disabled"],Y={key:0,class:"w-6 h-6 border-2 border-current border-t-transparent rounded-full animate-spin"},Z={class:"text-[11px] font-semibold uppercase tracking-wider opacity-70"},ee={key:0,class:"text-2xl font-bold tabular-nums tracking-tight"},te={key:1,xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},ae={class:"text-center space-y-1.5"},le={key:0,class:"badge-success mb-2"},se={key:1,class:"badge-success mb-2"},oe={key:2,class:"text-sm text-slate-400"},ne={class:"text-white font-medium"},re={key:3,class:"text-sm text-slate-400"},ce={class:"text-white font-medium"},ue={key:4,class:"text-sm text-slate-500"},ie={key:0,class:"mt-3 text-xs text-red-400 text-center max-w-[220px]"},de=8*60*60,w=82,ye=L({__name:"ClockWidget",emits:["punched"],setup(C,{emit:y}){O();const i=m(!1),v=m(""),a=m(!1),t=m(!1),r=m(null),l=m(0);let s=null;const h=d(()=>l.value===0?0:Math.min(l.value/de,1)),f=d(()=>h.value>=1),M=2*Math.PI*w,z=d(()=>M*(1-h.value)),S=d(()=>{const e=Math.floor(l.value/3600),c=Math.floor(l.value%3600/60),$=l.value%60;return`${String(e).padStart(2,"0")}:${String(c).padStart(2,"0")}:${String($).padStart(2,"0")}`}),g=d(()=>r.value?r.value.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""),A=d(()=>t.value||f.value?"#22c55e":"#ef4444"),B=d(()=>t.value||f.value?"rgba(34, 197, 94, 0.35)":"rgba(239, 68, 68, 0.25)"),E=d(()=>t.value?"Day Complete":a.value?"Clock Out":"Clock In"),F=d(()=>i.value||t.value);function D(){k(),s=setInterval(()=>{r.value&&(l.value=Math.floor((Date.now()-r.value.getTime())/1e3))},1e3)}function k(){s&&(clearInterval(s),s=null)}let I=!1;function V(){return x(this,null,function*(){if(!I){I=!0;try{const e=yield N.getTodayCheckin();e.clock_in&&e.clock_out?(t.value=!0,a.value=!1,r.value=new Date(e.clock_in),l.value=Math.floor((new Date(e.clock_out).getTime()-new Date(e.clock_in).getTime())/1e3),k()):e.clock_in&&!e.clock_out?(a.value=!0,t.value=!1,r.value=new Date(e.clock_in),l.value=Math.floor((Date.now()-r.value.getTime())/1e3),D()):(a.value=!1,t.value=!1,r.value=null,l.value=0)}catch(e){}}})}function q(){return x(this,null,function*(){if(!t.value){i.value=!0,v.value="";try{const e=yield N.punch();e.status==="success"?(e.log_type==="IN"?(a.value=!0,t.value=!1,r.value=new Date(e.time),l.value=0,D()):(a.value=!1,t.value=!0,k()),H("punched")):v.value=e.error||"Punch failed"}catch(e){v.value=e.message||"Something went wrong"}finally{i.value=!1}}})}P(V),R(k);const H=y;return(e,c)=>(o(),n("div",X,[u("div",G,[(o(),n("svg",J,[u("circle",{cx:100,cy:100,r:w,fill:"none",class:"clock-ring-bg","stroke-width":"6"}),u("circle",{cx:100,cy:100,r:w,fill:"none",stroke:A.value,"stroke-width":"6","stroke-linecap":"round",class:"clock-ring-progress","stroke-dasharray":M,"stroke-dashoffset":z.value},null,8,K)])),u("button",{onClick:q,disabled:F.value,class:j(["absolute inset-0 m-auto w-[140px] h-[140px] rounded-full flex flex-col items-center justify-center gap-1 transition-all duration-500 focus:outline-none",[t.value?"bg-emerald-500/15 text-emerald-400 cursor-default":a.value?f.value?"bg-emerald-500/15 text-emerald-400 hover:bg-emerald-500/25":"bg-red-500/10 text-red-400 hover:bg-red-500/20":"bg-white/[0.05] text-slate-300 hover:bg-white/[0.08] hover:text-white"]]),style:U(a.value||t.value?{boxShadow:`0 0 40px ${B.value}`}:{})},[i.value?(o(),n("div",Y)):(o(),n(W,{key:1},[u("span",Z,p(E.value),1),a.value||t.value?(o(),n("span",ee,p(S.value),1)):(o(),n("svg",te,[...c[0]||(c[0]=[u("circle",{cx:"12",cy:"12",r:"10"},null,-1),u("polyline",{points:"12 6 12 12 16 14"},null,-1)])]))],64))],14,Q)]),u("div",ae,[t.value?(o(),n("div",le," Day Complete ")):f.value&&a.value?(o(),n("div",se," Shift Complete ")):T("",!0),t.value&&g.value?(o(),n("p",oe,[c[1]||(c[1]=_(" Worked ",-1)),u("span",ne,p(S.value),1),c[2]||(c[2]=_(" today ",-1))])):a.value&&g.value?(o(),n("p",re,[c[3]||(c[3]=_(" Clocked in at ",-1)),u("span",ce,p(g.value),1)])):(o(),n("p",ue," Tap to start your shift "))]),v.value?(o(),n("p",ie,p(v.value),1)):T("",!0)]))}});export{ke as C,ye as _,pe as a,fe as b};
