var T=(M,g,c)=>new Promise((u,r)=>{var p=i=>{try{x(c.next(i))}catch(m){r(m)}},k=i=>{try{x(c.throw(i))}catch(m){r(m)}},x=i=>i.done?u(i.value):Promise.resolve(i.value).then(p,k);x((c=c.apply(M,g)).next())});import{c as U,d as Y,r as h,x as I,m as K,a as n,b as e,f as R,y as q,F as y,n as b,g as v,h as _,t as o,i as C,C as z,p as w,o as l,q as f,j as E,s as W,k as F}from"./main.js";import{a as X,l as G}from"./api.js";import{_ as J,C as Q,a as Z,b as ee}from"./ClockWidget.vue_vue_type_script_setup_true_lang.js";import{C as te}from"./chevron-down.js";import{C as se}from"./calendar.js";/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=U("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),ae={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-8 animate-fade-in"},le={class:"flex items-center gap-2 shrink-0"},ne={class:"relative"},oe=["value"],re={class:"glass-card p-6 sm:p-8 flex flex-col items-center justify-center mb-6"},ie={key:0,class:"flex items-center justify-center py-12"},de={key:1,class:"space-y-6 animate-slide-up"},ce={class:"grid grid-cols-2 sm:grid-cols-4 gap-4"},ue={class:"flex items-center justify-between mb-3"},me={class:"text-sm font-medium text-slate-400"},pe={key:0,class:"glass-card p-5"},xe={class:"text-sm font-semibold text-slate-400 uppercase tracking-wider mb-4"},he={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3"},ve={class:"w-10 h-10 rounded-lg bg-amber-500/10 text-amber-400 flex items-center justify-center shrink-0"},fe={class:"min-w-0"},ge={class:"text-sm font-medium text-white"},ye={class:"text-xs text-slate-500 truncate"},be={key:0,class:"glass-card overflow-hidden"},_e={class:"hidden sm:block overflow-x-auto"},we={class:"w-full"},ke={class:"px-5 py-4"},De={class:"text-sm font-medium text-white"},Ce={class:"px-5 py-4 text-center"},Ae={class:"px-5 py-4 text-center"},Me={class:"text-sm text-slate-300"},He={class:"px-5 py-4 text-center"},Le={class:"text-sm text-slate-300"},Se={class:"px-5 py-4 text-center"},$e={class:"sm:hidden divide-y divide-white/[0.04]"},je={class:"flex items-center justify-between"},Ne={class:"text-sm font-medium text-white"},Te={class:"flex items-center gap-4 text-xs text-slate-500"},ze={key:0},Fe={key:1},Oe={key:1,class:"glass-card p-8 text-center"},Ke=Y({__name:"AttendanceView",setup(M){const g=h(!0),c=new Date,u=h(c.getMonth()+1),r=h(c.getFullYear()),p=h([]),k=h({}),x=h([]),i=w(()=>{const a=[],s=new Date;for(let d=-12;d<=2;d++){const t=new Date(s.getFullYear(),s.getMonth()+d,1),j=t.getMonth()+1,N=t.getFullYear();a.push({value:`${N}-${j}`,label:t.toLocaleDateString("en-US",{month:"long",year:"numeric"}),month:j,year:N})}return a}),m=w({get:()=>`${r.value}-${u.value}`,set:a=>{const[s,d]=a.split("-").map(Number);r.value=s,u.value=d}}),P=w(()=>`${r.value}-${String(u.value).padStart(2,"0")}`),H=w(()=>x.value.filter(a=>a.holiday_date.startsWith(P.value))),V=w(()=>{const a=k.value||{};return[{label:"Present",value:a.Present||0,icon:z,color:"text-emerald-400",bg:"bg-emerald-500/10"},{label:"Absent",value:a.Absent||0,icon:Q,color:"text-red-400",bg:"bg-red-500/10"},{label:"Half Day",value:a["Half Day"]||0,icon:Z,color:"text-amber-400",bg:"bg-amber-500/10"},{label:"On Leave",value:a["On Leave"]||0,icon:ee,color:"text-blue-400",bg:"bg-blue-500/10"}]});function L(a){return{Present:"text-emerald-400",Absent:"text-red-400","Half Day":"text-amber-400","On Leave":"text-blue-400"}[a]||"text-slate-400"}function S(a){return{Present:"badge-success",Absent:"badge-danger","Half Day":"badge-warning","On Leave":"badge-info"}[a]||"badge-neutral"}function D(a){if(!a)return"—";try{const s=new Date(a);return isNaN(s.getTime())?a:s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}catch(s){return a}}function $(a){try{return new Date(a).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})}catch(s){return a}}function A(){return T(this,null,function*(){g.value=!0;try{const[a,s]=yield Promise.allSettled([X.getRecords(u.value,r.value),G.getHolidays(`${r.value}-01-01`,`${r.value}-12-31`)]);a.status==="fulfilled"&&a.value&&(p.value=a.value.records||[],k.value=a.value.summary||{}),s.status==="fulfilled"&&(x.value=Array.isArray(s.value)?s.value:[])}finally{g.value=!1}})}I([u,r],()=>{A()});function B(){A()}return K(A),(a,s)=>{var d;return l(),n("div",null,[e("div",ae,[s[2]||(s[2]=e("div",null,[e("h1",{class:"text-2xl sm:text-3xl font-bold text-white"},"Attendance"),e("p",{class:"text-sm text-slate-500 mt-1"},"Track your daily attendance and working hours")],-1)),e("div",le,[s[1]||(s[1]=e("label",{class:"text-xs text-slate-500 whitespace-nowrap"},"Month:",-1)),e("div",ne,[R(e("select",{"onUpdate:modelValue":s[0]||(s[0]=t=>m.value=t),class:"input-dark appearance-none pr-8 pl-3 py-2 text-sm cursor-pointer min-w-[180px] border border-white/10 rounded-lg"},[(l(!0),n(y,null,b(i.value,t=>(l(),n("option",{key:t.value,value:t.value},o(t.label),9,oe))),128))],512),[[q,m.value]]),v(_(te),{size:14,class:"absolute right-2.5 top-1/2 -translate-y-1/2 text-slate-500 pointer-events-none"})])])]),e("div",re,[s[3]||(s[3]=e("h2",{class:"text-sm font-semibold text-slate-400 uppercase tracking-wider mb-6"},"Today's Clock",-1)),v(J,{onPunched:B})]),g.value?(l(),n("div",ie,[...s[4]||(s[4]=[e("div",{class:"w-10 h-10 border-2 border-accent/30 border-t-accent rounded-full animate-spin"},null,-1)])])):(l(),n("div",de,[e("div",ce,[(l(!0),n(y,null,b(V.value,t=>(l(),n("div",{key:t.label,class:"glass-card-hover p-5"},[e("div",ue,[e("span",me,o(t.label),1),e("div",{class:f([[t.bg,t.color],"w-9 h-9 rounded-xl flex items-center justify-center"])},[(l(),E(W(t.icon),{size:18,"stroke-width":1.8}))],2)]),e("p",{class:f(["stat-number",t.color])},o(t.value),3)]))),128))]),H.value.length?(l(),n("div",pe,[e("h3",xe," Holidays in "+o(((d=i.value.find(t=>t.value===m.value))==null?void 0:d.label)||"Selected Month"),1),e("div",he,[(l(!0),n(y,null,b(H.value,t=>(l(),n("div",{key:t.holiday_date,class:"flex items-center gap-3 py-2 px-3 rounded-lg bg-white/[0.03] border border-white/[0.04]"},[e("div",ve,[v(_(se),{size:18,"stroke-width":1.8})]),e("div",fe,[e("p",ge,o(new Date(t.holiday_date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})),1),e("p",ye,o(t.description||"Holiday"),1)])]))),128))])])):C("",!0),e("div",null,[s[7]||(s[7]=e("h3",{class:"text-sm font-semibold text-slate-400 uppercase tracking-wider mb-4"}," Attendance Records ",-1)),p.value.length?(l(),n("div",be,[e("div",_e,[e("table",we,[s[5]||(s[5]=e("thead",null,[e("tr",{class:"border-b border-white/[0.06]"},[e("th",{class:"text-left text-xs font-semibold text-slate-500 uppercase tracking-wider px-5 py-3"},"Date"),e("th",{class:"text-center text-xs font-semibold text-slate-500 uppercase tracking-wider px-5 py-3"},"Status"),e("th",{class:"text-center text-xs font-semibold text-slate-500 uppercase tracking-wider px-5 py-3"},"In Time"),e("th",{class:"text-center text-xs font-semibold text-slate-500 uppercase tracking-wider px-5 py-3"},"Out Time"),e("th",{class:"text-center text-xs font-semibold text-slate-500 uppercase tracking-wider px-5 py-3"},"Hours")])],-1)),e("tbody",null,[(l(!0),n(y,null,b(p.value,t=>(l(),n("tr",{key:t.date,class:"border-b border-white/[0.03] hover:bg-white/[0.02] transition-colors"},[e("td",ke,[e("p",De,o($(t.date)),1)]),e("td",Ce,[e("span",{class:f(S(t.status))},o(t.status),3)]),e("td",Ae,[e("span",Me,o(D(t.in_time)),1)]),e("td",He,[e("span",Le,o(D(t.out_time)),1)]),e("td",Se,[e("span",{class:f(["text-sm font-semibold",L(t.status)])},o(t.working_hours>0?t.working_hours.toFixed(1)+"h":"—"),3)])]))),128))])])]),e("div",$e,[(l(!0),n(y,null,b(p.value,t=>(l(),n("div",{key:t.date,class:"p-4 space-y-2"},[e("div",je,[e("p",Ne,o($(t.date)),1),e("span",{class:f(S(t.status))},o(t.status),3)]),e("div",Te,[t.in_time?(l(),n("span",ze,[v(_(O),{size:12,class:"inline mr-1"}),F("In: "+o(D(t.in_time)),1)])):C("",!0),t.out_time?(l(),n("span",Fe,[v(_(O),{size:12,class:"inline mr-1"}),F("Out: "+o(D(t.out_time)),1)])):C("",!0),t.working_hours>0?(l(),n("span",{key:2,class:f(L(t.status))},o(t.working_hours.toFixed(1))+"h ",3)):C("",!0)])]))),128))])])):(l(),n("div",Oe,[v(_(z),{size:32,class:"mx-auto text-slate-600 mb-2"}),s[6]||(s[6]=e("p",{class:"text-slate-500 text-sm"},"No attendance records for this month",-1))]))])]))])}}});export{Ke as default};
