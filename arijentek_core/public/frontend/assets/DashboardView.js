var I=(P,k,d)=>new Promise((v,a)=>{var u=h=>{try{g(d.next(h))}catch(x){a(x)}},c=h=>{try{g(d.throw(h))}catch(x){a(x)}},g=h=>h.done?v(h.value):Promise.resolve(h.value).then(u,c);g((d=d.apply(P,k)).next())});import{c as M,d as U,u as F,m as q,n as W,p as G,o as l,a as n,b as e,q as Q,s as z,F as B,t as o,i as L,k as w,r as y,x as p,h as m,y as V,g as _,T as R,W as X,l as J,j as K,z as Y}from"./main.js";import{a as E,d as Z,l as H}from"./api.js";import{B as ee}from"./briefcase.js";/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=M("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=M("building-2",[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=M("calendar-check",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=M("calendar-clock",[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]);/**
 * @license lucide-vue-next v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=M("calendar-x",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m14 14-4 4",key:"rymu2i"}],["path",{d:"m10 14 4 4",key:"3sz06r"}]]),ne={class:"flex flex-col items-center"},re={class:"relative mb-6"},ie={width:"200",height:"200",class:"transform -rotate-90"},ce=["stroke","stroke-dashoffset"],de=["disabled"],ue={key:0,class:"w-6 h-6 border-2 border-current border-t-transparent rounded-full animate-spin"},he={class:"text-[11px] font-semibold uppercase tracking-wider opacity-70"},me={key:0,class:"text-2xl font-bold tabular-nums tracking-tight"},ve={key:1,xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},pe={class:"text-center space-y-1.5"},ge={key:0,class:"badge-success mb-2"},xe={key:1,class:"text-sm text-slate-400"},fe={class:"text-white font-medium"},ye={key:2,class:"text-sm text-slate-400"},ke={class:"text-white font-medium"},be={key:3,class:"text-sm text-slate-500"},_e={key:0,class:"mt-3 text-xs text-red-400 text-center"},we=8*60*60,N=82,Ce=U({__name:"ClockWidget",emits:["punched"],setup(P,{emit:k}){F();const d=y(!1),v=y(""),a=y(!1),u=y(null),c=y(0);let g=null;const h=p(()=>!a.value||c.value===0?0:Math.min(c.value/we,1)),x=p(()=>h.value>=1),S=2*Math.PI*N,$=p(()=>S*(1-h.value)),T=p(()=>{const r=Math.floor(c.value/3600),f=Math.floor(c.value%3600/60),O=c.value%60;return`${String(r).padStart(2,"0")}:${String(f).padStart(2,"0")}:${String(O).padStart(2,"0")}`}),i=p(()=>u.value?u.value.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""),t=p(()=>x.value?"#22c55e":"#14b8a6"),b=p(()=>x.value?"rgba(34, 197, 94, 0.35)":"rgba(20, 184, 166, 0.25)");function D(){C(),g=setInterval(()=>{u.value&&(c.value=Math.floor((Date.now()-u.value.getTime())/1e3))},1e3)}function C(){g&&(clearInterval(g),g=null)}function s(){return I(this,null,function*(){try{const r=yield E.getTodayCheckin();r.clock_in&&!r.clock_out?(a.value=!0,u.value=new Date(r.clock_in),c.value=Math.floor((Date.now()-u.value.getTime())/1e3),D()):(a.value=!1,u.value=r.clock_in?new Date(r.clock_in):null,r.clock_in&&r.clock_out&&(c.value=Math.floor((new Date(r.clock_out).getTime()-new Date(r.clock_in).getTime())/1e3)))}catch(r){}})}function j(){return I(this,null,function*(){d.value=!0,v.value="";try{const r=yield E.punch();r.status==="success"?r.log_type==="IN"?(a.value=!0,u.value=new Date(r.time),c.value=0,D()):(a.value=!1,C()):v.value=r.error||"Punch failed"}catch(r){v.value=r.message||"Something went wrong"}finally{d.value=!1}})}q(s),W(C);const A=k;return G(a,()=>A("punched")),(r,f)=>(l(),n("div",ne,[e("div",re,[(l(),n("svg",ie,[e("circle",{cx:100,cy:100,r:N,fill:"none",class:"clock-ring-bg","stroke-width":"6"}),e("circle",{cx:100,cy:100,r:N,fill:"none",stroke:t.value,"stroke-width":"6","stroke-linecap":"round",class:"clock-ring-progress","stroke-dasharray":S,"stroke-dashoffset":$.value},null,8,ce)])),e("button",{onClick:j,disabled:d.value,class:z(["absolute inset-0 m-auto w-[140px] h-[140px] rounded-full flex flex-col items-center justify-center gap-1 transition-all duration-500 focus:outline-none",[a.value?x.value?"bg-emerald-500/15 text-emerald-400 hover:bg-emerald-500/25":"bg-accent/10 text-accent hover:bg-accent/20":"bg-white/[0.05] text-slate-300 hover:bg-white/[0.08] hover:text-white"]]),style:Q(a.value?{boxShadow:`0 0 40px ${b.value}`}:{})},[d.value?(l(),n("div",ue)):(l(),n(B,{key:1},[e("span",he,o(a.value?"Clock Out":"Clock In"),1),a.value?(l(),n("span",me,o(T.value),1)):(l(),n("svg",ve,[...f[0]||(f[0]=[e("circle",{cx:"12",cy:"12",r:"10"},null,-1),e("polyline",{points:"12 6 12 12 16 14"},null,-1)])]))],64))],14,de)]),e("div",pe,[x.value?(l(),n("div",ge," Shift Complete ")):L("",!0),a.value&&i.value?(l(),n("p",xe,[f[1]||(f[1]=w(" Clocked in at ",-1)),e("span",fe,o(i.value),1)])):!a.value&&c.value>0?(l(),n("p",ye,[f[2]||(f[2]=w(" Worked ",-1)),e("span",ke,o(T.value),1),f[3]||(f[3]=w(" today ",-1))])):(l(),n("p",be," Tap to start your shift "))]),v.value?(l(),n("p",_e,o(v.value),1)):L("",!0)]))}}),De={class:"mb-8 animate-fade-in"},Me={class:"text-2xl sm:text-3xl font-bold text-white"},Se={class:"text-accent"},$e={class:"text-sm text-slate-500 mt-1"},Te={key:0,class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},je={key:1,class:"space-y-6 animate-slide-up"},Ae={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Ie={class:"glass-card p-6 sm:p-8 lg:row-span-2 flex flex-col items-center justify-center"},ze={class:"flex items-center justify-between mb-3"},Be={class:"text-sm font-medium text-slate-400"},Le={class:"text-xs text-slate-500 mt-1"},Pe={class:"glass-card-hover p-5"},Ve={class:"flex items-center justify-between mb-3"},Ne={class:"w-9 h-9 rounded-xl bg-teal-500/10 text-teal-400 flex items-center justify-center"},Re={class:"stat-number text-teal-400"},Ee={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},He={class:"glass-card p-6"},Ue={class:"space-y-3"},Fe={class:"flex items-center gap-3"},qe={class:"w-8 h-8 rounded-lg bg-blue-500/10 text-blue-400 flex items-center justify-center"},Oe={class:"text-sm font-medium text-white"},We={class:"flex items-center gap-3"},Ge={class:"w-8 h-8 rounded-lg bg-purple-500/10 text-purple-400 flex items-center justify-center"},Qe={class:"text-sm font-medium text-white"},Xe={class:"glass-card p-6"},Je={class:"grid grid-cols-2 gap-3"},Ke={key:0,class:"glass-card p-6"},Ye={class:"flex items-center justify-between mb-4"},Ze={class:"space-y-3"},et={class:"text-sm font-medium text-white"},tt={class:"text-xs text-slate-500"},st={key:0},rt=U({__name:"DashboardView",setup(P){const k=J(),d=F(),v=y(!0),a=y(null),u=y([]),c=y([]),g=p(()=>{const i=new Date().getHours();return i<12?"Good Morning":i<17?"Good Afternoon":"Good Evening"}),h=p(()=>new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})),x=p(()=>{var t;const i=((t=a.value)==null?void 0:t.attendance_summary)||{};return[{label:"Present",value:i.Present||0,icon:ae,color:"text-emerald-400",bg:"bg-emerald-500/10"},{label:"Absent",value:i.Absent||0,icon:oe,color:"text-red-400",bg:"bg-red-500/10"},{label:"Half Day",value:i["Half Day"]||0,icon:le,color:"text-amber-400",bg:"bg-amber-500/10"}]}),S=p(()=>u.value.reduce((i,t)=>i+t.balance,0));function $(){return I(this,null,function*(){v.value=!0;try{const[i,t,b]=yield Promise.allSettled([Z.getData(),H.getBalance(),H.getApplications()]);i.status==="fulfilled"&&(a.value=i.value),t.status==="fulfilled"&&(u.value=t.value||[]),b.status==="fulfilled"&&(c.value=(b.value||[]).slice(0,3))}finally{v.value=!1}})}function T(i){return{Open:"badge-warning",Approved:"badge-success",Rejected:"badge-danger",Cancelled:"badge-neutral"}[i]||"badge-neutral"}return q($),(i,t)=>{var b,D,C;return l(),n("div",null,[e("div",De,[e("h1",Me,[w(o(g.value)+", ",1),e("span",Se,o(((b=m(d).fullName)==null?void 0:b.split(" ")[0])||"there"),1)]),e("p",$e,o(h.value),1)]),v.value?(l(),n("div",Te,[t[4]||(t[4]=e("div",{class:"glass-card p-8 lg:row-span-2 flex items-center justify-center"},[e("div",{class:"w-12 h-12 border-2 border-accent/30 border-t-accent rounded-full animate-spin"})],-1)),(l(),n(B,null,V(4,s=>e("div",{key:s,class:"glass-card p-6 animate-pulse"},[...t[3]||(t[3]=[e("div",{class:"h-4 bg-white/5 rounded w-20 mb-3"},null,-1),e("div",{class:"h-8 bg-white/5 rounded w-12"},null,-1)])])),64))])):(l(),n("div",je,[e("div",Ae,[e("div",Ie,[t[5]||(t[5]=e("h2",{class:"text-sm font-semibold text-slate-400 uppercase tracking-wider mb-6"},"Attendance",-1)),_(Ce,{onPunched:$})]),(l(!0),n(B,null,V(x.value,s=>{var j,A;return l(),n("div",{key:s.label,class:"glass-card-hover p-5"},[e("div",ze,[e("span",Be,o(s.label),1),e("div",{class:z([[s.bg,s.color],"w-9 h-9 rounded-xl flex items-center justify-center"])},[(l(),K(Y(s.icon),{size:18,"stroke-width":1.8}))],2)]),e("p",{class:z(["stat-number",s.color])},o(s.value),3),e("p",Le,o((j=a.value)==null?void 0:j.current_month)+" "+o((A=a.value)==null?void 0:A.year),1)])}),128)),e("div",Pe,[e("div",Ve,[t[6]||(t[6]=e("span",{class:"text-sm font-medium text-slate-400"},"Leave Balance",-1)),e("div",Ne,[_(m(R),{size:18,"stroke-width":1.8})])]),e("p",Re,o(S.value),1),t[7]||(t[7]=e("p",{class:"text-xs text-slate-500 mt-1"},"days remaining",-1))])]),e("div",Ee,[e("div",He,[t[10]||(t[10]=e("h3",{class:"text-sm font-semibold text-slate-400 uppercase tracking-wider mb-4"},"Profile",-1)),e("div",Ue,[e("div",Fe,[e("div",qe,[_(m(ee),{size:16,"stroke-width":1.8})]),e("div",null,[t[8]||(t[8]=e("p",{class:"text-xs text-slate-500"},"Designation",-1)),e("p",Oe,o(m(d).designation||((D=a.value)==null?void 0:D.designation)||"—"),1)])]),e("div",We,[e("div",Ge,[_(m(se),{size:16,"stroke-width":1.8})]),e("div",null,[t[9]||(t[9]=e("p",{class:"text-xs text-slate-500"},"Department",-1)),e("p",Qe,o(m(d).department||((C=a.value)==null?void 0:C.department)||"—"),1)])])])]),e("div",Xe,[t[13]||(t[13]=e("h3",{class:"text-sm font-semibold text-slate-400 uppercase tracking-wider mb-4"},"Quick Actions",-1)),e("div",Je,[e("button",{onClick:t[0]||(t[0]=s=>m(k).push("/leave")),class:"flex items-center gap-2 p-4 rounded-xl bg-white/[0.03] hover:bg-white/[0.06] border border-white/[0.04] hover:border-white/[0.08] transition-all group"},[_(m(R),{size:18,class:"text-teal-400","stroke-width":1.8}),t[11]||(t[11]=e("span",{class:"text-sm font-medium text-slate-300 group-hover:text-white"},"Apply Leave",-1))]),e("button",{onClick:t[1]||(t[1]=s=>m(k).push("/payroll")),class:"flex items-center gap-2 p-4 rounded-xl bg-white/[0.03] hover:bg-white/[0.06] border border-white/[0.04] hover:border-white/[0.08] transition-all group"},[_(m(X),{size:18,class:"text-emerald-400","stroke-width":1.8}),t[12]||(t[12]=e("span",{class:"text-sm font-medium text-slate-300 group-hover:text-white"},"View Payslips",-1))])])])]),c.value.length?(l(),n("div",Ke,[e("div",Ye,[t[15]||(t[15]=e("h3",{class:"text-sm font-semibold text-slate-400 uppercase tracking-wider"},"Recent Leave",-1)),e("button",{onClick:t[2]||(t[2]=s=>m(k).push("/leave")),class:"text-xs text-accent hover:text-accent-light flex items-center gap-1 transition-colors"},[t[14]||(t[14]=w(" View all ",-1)),_(m(te),{size:14})])]),e("div",Ze,[(l(!0),n(B,null,V(c.value,s=>(l(),n("div",{key:s.name,class:"flex items-center justify-between py-3 border-b border-white/[0.04] last:border-0"},[e("div",null,[e("p",et,o(s.leave_type),1),e("p",tt,[w(o(new Date(s.from_date).toLocaleDateString("en-US",{month:"short",day:"numeric"}))+" ",1),s.from_date!==s.to_date?(l(),n("span",st," — "+o(new Date(s.to_date).toLocaleDateString("en-US",{month:"short",day:"numeric"})),1)):L("",!0),w(" · "+o(s.total_leave_days)+" day"+o(s.total_leave_days!==1?"s":""),1)])]),e("span",{class:z(T(s.status))},o(s.status),3)]))),128))])])):L("",!0)]))])}}});export{rt as default};
